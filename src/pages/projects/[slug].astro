---
import { getEntry, getCollection, render } from "astro:content";
import ProjectLayout from "../../layouts/ProjectLayout.astro";

// Provide all valid slugs for static generation.
export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((entry) => ({ params: { slug: entry.slug } }));
}

const { slug } = Astro.params;
const entry = await getEntry("projects", slug);
if (!entry) throw new Error(`Project not found: ${slug}`);

const { Content } = await render(entry);
const { data: frontmatter } = entry;
---

<ProjectLayout {...frontmatter}>
  <Content />
</ProjectLayout>
