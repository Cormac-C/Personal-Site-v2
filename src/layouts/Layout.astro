---
import 'bootstrap/dist/css/bootstrap.min.css';
import AnalyticsWrapper from '../components/analyticsWrapper';
import { siteMeta, buildSeo } from '../lib/siteMeta';
import { getColorSchemePreference } from '../lib/utils';

// Accept props: title override or a richer seo object
const { title: titleProp, seo: seoInput = {} } = Astro.props as any;
const seo = buildSeo(siteMeta, { title: titleProp, ...(seoInput || {}) });
const title = seo.title;
const createThemedIconHref = (char: string = "ⓒ"): string => {
    const colorScheme = getColorSchemePreference();
    return `data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90' fill='${colorScheme === "dark" ? "white" : "black"}'>${char}</text></svg>`;
  };
---

<!doctype html>
<html lang="en" class="min-h-full">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" href={createThemedIconHref("ⓒ")} />
		<link rel="sitemap" href="/sitemap-index.xml" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta name="description" content={seo.description} />
		<meta name="image" content={seo.image} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={seo.description} />
		<meta property="og:type" content={seo.type} />
		<meta property="og:url" content={seo.url} />
		<meta property="og:image" content={seo.image} />
		{seo.publishedTime && <meta property="article:published_time" content={seo.publishedTime} />}
		{seo.modifiedTime && <meta property="article:modified_time" content={seo.modifiedTime} />}
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={seo.description} />
		<meta name="twitter:image" content={seo.image} />
		{siteMeta.twitterHandle && <meta name="twitter:site" content={siteMeta.twitterHandle} />}
		{siteMeta.googleVerification && <meta name="google-site-verification" content={siteMeta.googleVerification} />}
		{seo.noIndex && <meta name="robots" content="noindex,nofollow" />}
	</head>
	<body class="min-h-full antialiased bg-white text-gray-900">
		<slot />
		<AnalyticsWrapper client:load/>
	</body>
</html>
